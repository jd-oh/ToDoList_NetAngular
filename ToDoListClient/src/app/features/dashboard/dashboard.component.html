<div class="dashboard-container">
  <div class="dashboard-header">
    <h1>Dashboard</h1>
    <p>Resumen de tus tareas</p>
  </div>

  @if (loading()) {
    <div class="loading-container">
      <mat-spinner diameter="50"></mat-spinner>
      <p>Cargando estadísticas...</p>
    </div>
  } @else {
    <div class="stats-grid">
      <mat-card class="stat-card total">
        <mat-card-content>
          <div class="stat-icon">
            <mat-icon>assignment</mat-icon>
          </div>
          <div class="stat-info">
            <span class="stat-label">Total de Tareas</span>
            <span class="stat-value">{{ dashboard()?.totalTasks ?? 0 }}</span>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card completed">
        <mat-card-content>
          <div class="stat-icon">
            <mat-icon>check_circle</mat-icon>
          </div>
          <div class="stat-info">
            <span class="stat-label">Completadas</span>
            <span class="stat-value">{{ dashboard()?.completedTasks ?? 0 }}</span>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card pending">
        <mat-card-content>
          <div class="stat-icon">
            <mat-icon>pending_actions</mat-icon>
          </div>
          <div class="stat-info">
            <span class="stat-label">Pendientes</span>
            <span class="stat-value">{{ dashboard()?.pendingTasks ?? 0 }}</span>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card progress">
        <mat-card-content>
          <div class="stat-icon">
            <mat-icon>trending_up</mat-icon>
          </div>
          <div class="stat-info">
            <span class="stat-label">Progreso</span>
            <span class="stat-value">{{ completionPercentage() }}%</span>
          </div>
          <mat-progress-bar 
            mode="determinate" 
            [value]="completionPercentage()"
            class="progress-bar">
          </mat-progress-bar>
        </mat-card-content>
      </mat-card>
    </div>

    <div class="dashboard-actions">
      <a mat-raised-button color="primary" routerLink="/tasks" class="action-button">
        <mat-icon>checklist</mat-icon>
        Ver todas las tareas
      </a>
    </div>

    @if (recentTodos().length > 0) {
      <mat-card class="recent-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>history</mat-icon>
            Tareas Recientes
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <mat-list>
            @for (todo of recentTodos().slice(0, 5); track todo.id) {
              <mat-list-item class="recent-item">
                <mat-icon matListItemIcon [class.completed-icon]="todo.isCompleted">
                  {{ todo.isCompleted ? 'check_circle' : 'radio_button_unchecked' }}
                </mat-icon>
                <span matListItemTitle [class.completed-text]="todo.isCompleted">
                  {{ todo.title }}
                </span>
                <span matListItemMeta>
                  <mat-chip [class]="todo.isCompleted ? 'chip-completed' : 'chip-pending'">
                    {{ todo.isCompleted ? 'Completada' : 'Pendiente' }}
                  </mat-chip>
                </span>
              </mat-list-item>
            }
          </mat-list>
        </mat-card-content>
      </mat-card>
    }
  }
</div>
