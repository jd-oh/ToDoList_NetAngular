<div class="todo-form">
  <div class="form-header">
    <mat-icon>{{ isEditMode ? 'edit' : 'add_task' }}</mat-icon>
    <h3>{{ isEditMode ? 'Editar Tarea' : 'Nueva Tarea' }}</h3>
  </div>
  
  <form [formGroup]="form" (ngSubmit)="onSubmit()">
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Título</mat-label>
      <input matInput 
             formControlName="title" 
             placeholder="¿Qué necesitas hacer?">
      <mat-icon matSuffix>title</mat-icon>
      @if (title?.invalid && title?.touched) {
        @if (title?.errors?.['required']) {
          <mat-error>El título es requerido</mat-error>
        } @else if (title?.errors?.['maxlength']) {
          <mat-error>El título no puede exceder 200 caracteres</mat-error>
        }
      }
      <mat-hint align="end">{{ form.get('title')?.value?.length || 0 }}/200</mat-hint>
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Descripción</mat-label>
      <textarea matInput 
                formControlName="description" 
                placeholder="Agrega más detalles (opcional)"
                rows="3"></textarea>
      <mat-icon matSuffix>description</mat-icon>
      @if (description?.errors?.['maxlength']) {
        <mat-error>La descripción no puede exceder 1000 caracteres</mat-error>
      }
      <mat-hint align="end">{{ form.get('description')?.value?.length || 0 }}/1000</mat-hint>
    </mat-form-field>

    @if (isEditMode) {
      <div class="checkbox-field">
        <mat-checkbox formControlName="isCompleted" color="primary">
          Marcar como completada
        </mat-checkbox>
      </div>
    }

    <div class="form-actions">
      <button mat-stroked-button type="button" (click)="onCancel()">
        <mat-icon>close</mat-icon>
        Cancelar
      </button>
      <button mat-raised-button color="primary" type="submit">
        <mat-icon>{{ isEditMode ? 'save' : 'add' }}</mat-icon>
        {{ isEditMode ? 'Guardar Cambios' : 'Crear Tarea' }}
      </button>
    </div>
  </form>
</div>
