<div class="todo-list-container">
  <div class="todo-header">
    <h2>ğŸ“‹ Mis Tareas</h2>
    <button class="btn-add" (click)="openForm()">
      â• Nueva Tarea
    </button>
  </div>

  <app-todo-filter 
    [currentFilter]="currentFilter()" 
    [dashboard]="dashboard()"
    (filterChange)="onFilterChange($event)">
  </app-todo-filter>

  @if (showForm()) {
    <app-todo-form
      (submitTodo)="onCreateTodo($event)"
      (cancel)="closeForm()">
    </app-todo-form>
  }

  @if (loading()) {
    <div class="loading-container">
      <div class="spinner-large"></div>
      <p>Cargando tareas...</p>
    </div>
  } @else {
    <div class="todo-items">
      @for (todo of todos(); track trackByTodoId($index, todo)) {
        @if (editingTodo()?.id === todo.id) {
          <app-todo-form
            [todo]="todo"
            (submitTodo)="onUpdateTodo({id: todo.id, todo: $event})"
            (cancel)="closeForm()">
          </app-todo-form>
        } @else {
          <app-todo-item
            [todo]="todo"
            (toggle)="onToggleTodo($event)"
            (edit)="onEditTodo($event)"
            (delete)="onDeleteTodo($event)">
          </app-todo-item>
        }
      } @empty {
        <div class="empty-state">
          <span class="empty-icon">ğŸ“</span>
          <h3>No hay tareas</h3>
          <p>
            @switch (currentFilter()) {
              @case ('completed') {
                No tienes tareas completadas
              }
              @case ('pending') {
                No tienes tareas pendientes
              }
              @default {
                Comienza creando tu primera tarea
              }
            }
          </p>
        </div>
      }
    </div>
  }
</div>
